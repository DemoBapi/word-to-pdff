<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Word to PDF – AnythingAnytime</title>
  <style>
    body { font-family: Arial, sans-serif; margin:0; padding:0; background:#f5f5f5; line-height:1.6; }
    header { background:#1a73e8; color:#fff; padding:20px; display:flex; justify-content:space-between; align-items:center; }
    header h1 { margin:0; font-size:22px; }
    nav a { color:#fff; margin-left:18px; text-decoration:none; font-weight:600; }
    .container { max-width:920px; margin:36px auto; background:#fff; padding:28px; border-radius:8px; box-shadow:0 6px 18px rgba(0,0,0,0.06); }
    .tool-title { font-size:26px; margin-bottom:10px; text-align:left; }
    .tool-desc { font-size:15px; margin-bottom:18px; color:#444; }
    .upload-area { border:2px dashed #1a73e8; padding:28px; text-align:center; border-radius:8px; margin-bottom:18px; cursor:pointer; transition:0.18s; background:#fff; }
    .upload-area:hover { background:#eaf2ff; }
    .upload-area input { display:none; }
    .file-info { margin:12px 0; color:#333; font-weight:600; }
    button.convert-btn { background:#1a73e8; color:#fff; padding:12px 20px; border:none; border-radius:6px; cursor:pointer; font-size:15px; }
    .preview-wrap { margin-top:18px; }
    iframe.preview { width:100%; height:640px; border:1px solid #ddd; border-radius:6px; display:none; }
    .notice { color:#c00; margin-top:12px; }
    footer { text-align:center; padding:18px; background:#1a73e8; color:#fff; margin-top:28px; font-size:14px; }
  </style>
</head>
<body>
<header>
  <h1>AnythingAnytime</h1>
  <nav>
    <a href="#">Home</a>
    <a href="#">Tools</a>
    <a href="#">Contact</a>
  </nav>
</header>

<div class="container">
  <div class="tool-title">Word → PDF (Accurate conversion using server)</div>
  <div class="tool-desc">Upload a .docx or .doc file. The server converts it to a properly rendered PDF (uses LibreOffice). Preview will appear below and you can download the PDF.</div>

  <label class="upload-area">
    <input type="file" id="fileInput" accept=".doc,.docx" />
    Click or drag & drop a Word file here
  </label>

  <div class="file-info" id="fileInfo">No file selected</div>

  <div style="text-align:left;">
    <button class="convert-btn" id="convertBtn">Upload & Convert</button>
    <span class="notice" id="notice" aria-live="polite"></span>
  </div>

  <div class="preview-wrap">
    <iframe id="pdfPreview" class="preview" title="PDF preview"></iframe>
  </div>
</div>

<footer>&copy; 2025 AnythingAnytime</footer>

<script>
const fileInput = document.getElementById('fileInput');
const fileInfo = document.getElementById('fileInfo');
const convertBtn = document.getElementById('convertBtn');
const notice = document.getElementById('notice');
const pdfPreview = document.getElementById('pdfPreview');

let selectedFile = null;

fileInput.addEventListener('change', () => {
  if (fileInput.files.length) {
    selectedFile = fileInput.files[0];
    fileInfo.textContent = `Selected: ${selectedFile.name} — ${(selectedFile.size/1024).toFixed(1)} KB`;
    pdfPreview.style.display = 'none';
    pdfPreview.src = '';
    notice.textContent = '';
  } else {
    selectedFile = null;
    fileInfo.textContent = 'No file selected';
  }
});

convertBtn.addEventListener('click', async () => {
  if (!selectedFile) {
    notice.textContent = 'Please choose a .doc or .docx file first.';
    return;
  }

  notice.textContent = 'Uploading and converting...';
  convertBtn.disabled = true;

  const form = new FormData();
  form.append('file', selectedFile);

  try {
    // Change backend URL to your deployed server (see backend/README.md)
    const resp = await fetch('/convert', { method: 'POST', body: form });
    if (!resp.ok) {
      const txt = await resp.text();
      throw new Error(txt || 'Server error');
    }
    const blob = await resp.blob();
    const url = URL.createObjectURL(blob);
    pdfPreview.src = url;
    pdfPreview.style.display = 'block';
    notice.textContent = 'Conversion finished. Preview shown below — right-click the preview to save or use browser download control.';
  } catch (err) {
    console.error(err);
    notice.textContent = 'Conversion failed: ' + (err.message || err);
  } finally {
    convertBtn.disabled = false;
  }
});
</script>
</body>
</html>
